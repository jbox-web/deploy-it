---
- hosts: "{{ HOST }}"
  remote_user: "{{ USER }}"
  port: "{{ PORT }}"
  gather_facts: no

  vars_files:
    - "{{ CONTAINER_VARS }}"

  vars:

    NGINX_SITES_DIR:    '/etc/nginx/sites-enabled'
    SITE_DIR:           "{{ NGINX_SITES_DIR }}/{{ APPLICATION_NAME }}"

  tasks:

    ## Frontend : standard configuration (80)
    - name: "Remove Nginx config dir : {{ SITE_DIR }}"
      file: state=absent dest={{ SITE_DIR }}
      notify:
        - reload nginx

  handlers:

    - name: reload nginx
      command: /etc/init.d/nginx reload
